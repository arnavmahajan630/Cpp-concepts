# Makefile for the project rooted at cpp-concepts/

# --- Configuration Variables ---
CXX = g++
CXXFLAGS = -std=c++17 -Wall -g
TARGET = my_app

# --- Directory and File Structure ---
# Directories
OOP_DIR = OOP
OP_OVERLOAD_DIR = $(OOP_DIR)/Operator_Overloading

# Source files (paths relative to the Makefile's location: cpp-concepts/)
MAIN_SRC = $(OOP_DIR)/main.cpp
MYSTRING_SRC = $(OP_OVERLOAD_DIR)/Mystring.cpp

# Header dependencies (used for the compile rule)
MYSTRING_HPP = $(OP_OVERLOAD_DIR)/Mystring.hpp
OPRUNNER_HPP = $(OP_OVERLOAD_DIR)/Oprunner.hpp

# Object files (intermediate .o files - created in the same directory as Makefile)
MAIN_OBJ = main.o
MYSTRING_OBJ = mystring.o

# --- Build Targets ---

# Default target: builds the executable
.PHONY: all
all: $(TARGET)

# Link the executable
$(TARGET): $(MAIN_OBJ) $(MYSTRING_OBJ)
	$(CXX) $(CXXFLAGS) $^ -o $@

# Compile main.cpp -> main.o
# Prerequisite: main.cpp needs Oprunner.hpp
# NOTE: The command must use the source file variable $(MAIN_SRC)
$(MAIN_OBJ): $(MAIN_SRC) $(OPRUNNER_HPP)
	$(CXX) $(CXXFLAGS) -c $(MAIN_SRC) -o $@

# Compile Mystring.cpp -> mystring.o
# Prerequisite: Mystring.cpp needs Mystring.hpp
# NOTE: The command must use the source file variable $(MYSTRING_SRC)
$(MYSTRING_OBJ): $(MYSTRING_SRC) $(MYSTRING_HPP)
	$(CXX) $(CXXFLAGS) -c $(MYSTRING_SRC) -o $@

# --- Utility Targets ---

# Run the program
.PHONY: run
run: $(TARGET)
	./$(TARGET)

# Clean up generated files
.PHONY: clean
clean:
	rm -f $(TARGET) *.o